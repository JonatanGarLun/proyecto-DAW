{% extends 'base.html' %}
{% load static %}
{% block links %}
	<link rel="stylesheet" href="{% static 'css/resultado.css' %}">
{% endblock %}
{% block content %}

    {% if combate.resultado == "victoria" %}
        <style>
            html, body {
                background-image: url("{% static 'resources/imgs/victoria.webp' %}");
            }
        </style>
    {% else %}
        <style>
            html, body {
                background-image: url("{% static 'resources/imgs/derrota.webp' %}");
            }
        </style>
    {% endif %}


    <div class="resultado-panel">

        <div class="resultado-header">

            {% if combate.resultado == "victoria" %}
                <img src="{% static 'resources/imgs/texto_victoria_nobg.webp' %}" alt="Victoria">
            {% else %}
                <img src="{% static 'resources/imgs/texto_derrota_nobg.webp' %}" alt="Derrota">
            {% endif %}
            <hr class="header-separator">
        </div>

        <div class="resultado-body">
            <div class="versus-section">
                <div class="jugador-col">
                    <h3>{{ jugador.nombre }}</h3>
                    <img src="{% static 'resources/Pixelarts/'|add:jugador.clase|add:'/'|add:jugador.clase|add:'_ataque.webp' %}"
                         alt="Jugador">
                    <div class="resultado-etiqueta">
                        {% if combate.resultado == "victoria" %}
                            <img src="{% static 'resources/imgs/texto_ganador_nobg.webp' %}" alt="Ganador"> {% else %}
                            <img src="{% static 'resources/imgs/texto_perdedor_nobg.webp' %}" alt="Perdedor"> {% endif %}
                    </div>
                </div>

                <div class="versus-col">
                    <div class="versus-text">VS</div>
                </div>

                <div class="enemigo-col">
                    <h3>{{ enemigo.nombre }}</h3>
                    <img src="{{ enemigo.imagen.url }}" alt="Enemigo">
                    <div class="resultado-etiqueta">
                        {% if combate.resultado == "victoria" %}
                            <img src="{% static 'resources/imgs/texto_perdedor_nobg.webp' %}" alt="Perdedor"> {% else %}
                            <img src="{% static 'resources/imgs/texto_ganador_nobg.webp' %}" alt="Ganador"> {% endif %}
                    </div>
                </div>
            </div>

            <hr class="body-separator">
        </div>

        <div class="resultado-footer">

            <div class="resultado-botones">
                <a href="{% url 'inicio' %}">üè† Men√∫ Principal</a>
                <a href="{% url 'continente' %}">üó∫Ô∏è Volver al Mapa</a>
            </div>

        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const overlay = document.getElementById("fade-overlay");
            if (!overlay) return;

            // Fade-in al cargar
            overlay.style.opacity = '1';
            overlay.style.pointerEvents = 'auto';
            setTimeout(() => {
                overlay.style.opacity = '0';
                setTimeout(() => {
                    overlay.style.pointerEvents = 'none';
                }, 400);
            }, 50);

            const enlaces = document.querySelectorAll("a[href]");
            enlaces.forEach(link => {
                link.addEventListener("click", (e) => {
                    const href = link.getAttribute("href");
                    if (!href || href === "#") return;

                    e.preventDefault();
                    overlay.style.opacity = '1';
                    overlay.style.pointerEvents = 'auto';
                    setTimeout(() => {
                        window.location.href = href;
                    }, 500);
                });
            });
        });

        window.addEventListener("pageshow", () => {
            const overlay = document.getElementById("fade-overlay");
            if (!overlay) return;
            overlay.style.opacity = '1';
            overlay.style.pointerEvents = 'auto';
            setTimeout(() => {
                overlay.style.opacity = '0';
                setTimeout(() => {
                    overlay.style.pointerEvents = 'none';
                }, 400);
            }, 50);
        });
    </script>

    <div id="fade-overlay"></div>

{% endblock %}

